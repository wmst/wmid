var PAGEHASH=IDSLUG=!1;$("head script").each(function(a,b){if(1<$(b).text().indexOf("Chat.PAGEHASH")){var d=$(b).text().split("\n");$.each(d,function(a,b){-1==b.indexOf("Chat.PAGEHASH")&&-1==b.indexOf("Chat.IDSLUG")||eval($.trim(b).replace("Chat.",""))})}});
if(PAGEHASH&&IDSLUG){var STAT={var_name:name,var_site:"dream_chat",var_storage_countid:null,var_storage_id:null,var_intst:null,var_count_send:{from:0,to:0},init:function(){STAT.set_isonline();STAT.set_complete();setInterval(function(){STAT.get_toserver()},5E3);setInterval(function(){STAT.set_isonline()},6E4)},set_isonline:function(){$.post("https://wmidbot.com/ajax.php",{module:"statistics",event:"is_online",data:{girl:name,site:STAT.var_site}},function(){})},set_storage_count:function(a){1==runned&&
$.post("https://wmidbot.com/ajax.php",{module:"statistics",event:"set_storage_count",data:{girl:name,storage_id:STAT.var_storage_id,json:null!=a?{id:a,count:STAT.var_count_send}:{count:STAT.var_count_send},site:STAT.var_site}},function(a){null!=a.data&&(STAT.var_storage_countid=a.data.id)})},set_complete:function(){var a="("+function(){$(document).ajaxComplete(function(a,b,d){a=b.responseText;-1==a.indexOf('"type":1')&&-1==a.indexOf('"type":9')&&-1==a.indexOf('"type":4')&&-1!=a.indexOf("type")&&$("#status").html(a)})}+
")();",b=document.createElement("script"),d=document.createElement("div");d.style.display="none";d.id="status";b.textContent=a;(document.head||document.documentElement).appendChild(b);document.body.appendChild(d)},get_toserver:function(){var a=$("#status").text();a&&($.post("http://wmidbot.com/ajax.php",{module:"statistics",event:"is_status",data:{girl:name,json:a,site:"dream_chat"}},function(){}),$("#status").text(""))}};$(".chatbody").prepend('<div class="block-container" style="font-size:18px;"><div class="block-head"><span id="infotext">'+
lang.g_sendingstoped+'</span> <code id="infohelp" title="'+lang.g_alreadydend+" <- "+lang.g_waitsend+'">0 &lt;- 0</code></div></div>');$(".contactlist").before($("#chatpopupbutton").css("width","97%"));$("#button-send").after('<a href="javascript:void(0)" id="wmid_trans" style="width:112px; height: 30px; background: #26ade4; text-indent: 0; line-height: 30px; margin-right: 10px; margin-top: 1px; font-weight: bold; color: #fff; float:right;text-decoration: none;font-size: 12px;text-align: center;">WMID Translate</a><style>div.chatbody #buttons {width:250px;}</style>');
$("#wmid_trans").click(function(){$.getJSON("https://translate.yandex.net/api/v1.5/tr.json/translate?key=trnsl.1.1.20150126T184957Z.5fb6344ed3c2ac7e.91869e08ede68d44e7604f7b6f5eaba93238c8dc&text="+encodeURIComponent(unescape($("#message").val()))+"&lang=en",function(a){console.log(a.text);200==a.code&&$("#message").val(unescape(encodeURIComponent(a.text[0])))})});var runned=!1,info=$("#infohelp"),tinfo=$("#infotext"),key="dream-chat-"+name,storage=localStorage.getItem(key),queue=[],SaveStorage=function(){try{localStorage.setItem(key,
JSON.stringify(storage))}catch(a){a==QUOTA_EXCEEDED_ERR&&alert(lang.g_quotaextended)}},Status=function(a){STAT.var_count_send.from=a;STAT.var_count_send.to=queue.length;info.text(a+" <- "+queue.length)},tos,top,sentids=",",inprogress=",",cnt=0,Stop,StartSender=function(){if(0<queue.length){var a=queue.shift();-1==$.inArray(a.id,[6048])?(console.log(a),$.post(location.protocol+"//"+location.hostname+"/chat/ajax.php?ts="+(new Date).getTime()+"&pid="+name,{__tcAction:"sendMessage",chatid:"",message:a.t,
targetid:a.id,pagehash:PAGEHASH,idslug:IDSLUG,auto_invite:"off"},function(b){a.F(!0)},"json").fail(function(){a.F(!1)})):a.F(!1)}runned&&("online"!=storage.goal&&0==queue.length?(Stop(),alert(lang.g_sendingfinished)):tos=setTimeout(StartSender,1E3+1E3*Math.random()))},Parse4Send=function(a,b){0<queue.length?tos=setTimeout(function(){Parse4Send(a,b)},1E3):$.each(a[0].data,function(a,c){c.id=parseInt(c.id);c.age=parseInt(c.age);storage.at=parseInt(storage.at);storage.af=parseInt(storage.af);storage.af<=
c.age&&c.age<=storage.at&&-1==inprogress.indexOf(","+c.id+",")&&-1==sentids.indexOf(","+c.id+",")&&!(c.id in storage.black)&&(inprogress+=c.id+",",queue.push({id:c.id,t:storage.text.replace(/{name}/ig,c.displayname).replace(/{age}/ig,c.age),F:function(a){a&&(sentids+=c.id+",",++cnt);Status(cnt)}}),runned&&Status(cnt))})};Stop=function(){runned&&(runned=!1,clearTimeout(tos),clearTimeout(top),inprogress=sentids=",",queue=[]);Status(cnt);tinfo.text(lang.g_sendingstoped).css("color","")};storage=storage?
$.parseJSON(storage)||{}:{};"undefined"==typeof storage.black&&(storage={black:{},goal:"online",af:30,at:100,text:""});MessHandle=function(a,b,d){switch(a.type){case "init":d({name:name,runned:runned,storage:storage});break;case "save":storage=a.storage;SaveStorage();break;case "start":setTimeout(function(){STAT.set_storage_count(STAT.var_storage_countid)},2E3);STAT.var_intst=setInterval(function(){STAT.set_storage_count(STAT.var_storage_countid)},3E4);runned||(runned=!0,inprogress=sentids=",","online"==
storage.goal?$.post(location.protocol+"//"+location.hostname+"/chat/ajax.php?ts="+(new Date).getTime()+"&pid="+name,{__tcAction:"onlineListRequest",idslug:IDSLUG,auto_invite:"off"},function(a){Parse4Send(a,1)},"json"):$("#contact-list .item-list").children("div").each(function(){var a=parseInt($(this).prop("id").replace("contact-user-",""));0<a&&-1==inprogress.indexOf(","+a+",")&&-1==sentids.indexOf(","+a+",")&&!(a in storage.black)&&(inprogress+=a+",",queue.push({id:a,t:storage.text.replace(/{login}/ig,
$("a:first",this).text()),F:function(b){b&&(sentids+=a+",",++cnt);Status(cnt)}}),Status(cnt))}),StartSender(),runned&&tinfo.text(lang.g_sendinggo).css("color","green"));d(!0);break;case "stop":STAT.var_storage_countid=null;clearInterval(STAT.var_intst);console.log(STAT.var_storage_countid);STAT.set_storage_count(STAT.var_storage_countid);Stop();d(!0);break;case "set_storage_id":localStorage.setItem(STAT.var_site+"storage_id_"+name,a.data),STAT.var_storage_id=localStorage[STAT.var_site+"storage_id_"+
name]}}}STAT.init();