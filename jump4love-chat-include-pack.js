(function(c){var a={var_name:name,var_site:"jump4love_chat",var_storage_countid:null,var_storage_id:null,var_intst:null,var_count_send:{from:0,to:0},init:function(){a.set_isonline();setInterval(function(){a.set_isonline()},6E4)},set_isonline:function(){c.post("https://wmidbot.com/ajax.php",{module:"statistics",event:"is_online",data:{girl:name,site:a.var_site}},function(){})},set_storage_count:function(b){1==e&&c.post("https://wmidbot.com/ajax.php",{module:"statistics",event:"set_storage_count",data:{girl:name,
storage_id:a.var_storage_id,json:null!=b?{id:b,count:a.var_count_send}:{count:a.var_count_send},site:a.var_site}},function(b){null!=b.data&&(a.var_storage_countid=b.data.id)})}};c(".video-transmit-block").after('<div class="block-container"><div class="block-head"><span id="infotext">'+lang.g_sendingstoped+'</span> <code id="infohelp" title="'+lang.g_alreadydend+" <- "+lang.g_waitsend+'">0 &lt;- 0</code></div></div>');(function(b){c(b).after('<a href="javascript:void(0)" id="wmid_trans" class="mod-button-2" style="width:90px; margin-right:10px;" ><span>WMID Translate</span></a>');
c("#wmid_trans").click(function(){c.getJSON("https://translate.yandex.net/api/v1.5/tr.json/translate?key=trnsl.1.1.20140925T082047Z.5055d7e52197b592.bda3ad29dbb6a6aa6d19098d6e9748aca550221e&text="+c("#send-message-handler").text()+"&lang=en",function(b){console.log(b.text);200==b.code&&c("#send-message-handler").text(b.text[0])})})})("#send_button");var e=!1,x=c("#infohelp"),t=c("#infotext"),u="jump4love-chat-"+name,d=localStorage.getItem(u),g=[],l=function(b){a.var_count_send.from=b;a.var_count_send.to=
g.length;x.text(b+" <- "+g.length)},n,v,h=",",f=",",k=0,p,w=function(){if(0<g.length){var b=g.shift();-1==c.inArray(b.id,[10397,12266,101389])?c.post(location.protocol+"//"+location.hostname+location.pathname,{ajax:1,mod:"messages",file:"send_message",user_id:b.id,message:b.t,f:1},function(a){if("ok"==a.result){b.F(!0);var c=location.pathname.replace(/\D+/g,""),m=document.createElement("script");m.text='if(!("'+b.id+'" in chatV'+c+"._chatSubscribed) || !chatV"+c+"._chatSubscribed["+b.id+"] || chatV"+
c+"._chatSubscribed["+b.id+"].chat_id < "+a.data.chat_id+")chatV"+c+"._chatSubscribed["+b.id+"]={chat_id:"+a.data.chat_id+",state:1};chatV"+c+"._addMessage("+JSON.stringify(a.data)+");";document.head.appendChild(m).parentNode.removeChild(m)}else b.F(!1)},"json").fail(function(){b.F(!1)}):b.F(!1)}e&&("online"!=d.goal&&0==g.length?(p(),alert(lang.g_sendingfinished)):n=setTimeout(w,4E3+3E3*Math.random()))},r=function(b,a){0<g.length?n=setTimeout(function(){r(b,a)},1E3):(c.each(b.online.list,function(b,
a){a.user_id=parseInt(a.user_id);d.af<=a.user_age&&a.user_age<=d.at&&-1==f.indexOf(","+a.user_id+",")&&-1==h.indexOf(","+a.user_id+",")&&!(a.user_id in d.black)&&(f+=a.user_id+",",g.push({id:a.user_id,t:d.text.replace(/{login}/ig,a.user_name).replace(/{age}/ig,a.user_age),F:function(b){b&&(h+=a.user_id+",",++k);l(k)}}),e&&l(k))}),e&&(a="ok"!=b.result||0==b.online.list.length||b.online.pager.cnt<=b.online.pager.num?1:a+1,v=setTimeout(function(){c.post(location.protocol+"//"+location.hostname+location.pathname,
{ajax:"1",mod:"users",off:a,clear:0},function(b){r(b,a)},"json")},1E3)))};p=function(){e&&(e=!1,clearTimeout(n),clearTimeout(v),f=h=",",g=[]);l(k);t.text(lang.g_sendingstoped).css("color","")};d=d?c.parseJSON(d)||{}:{};"undefined"==typeof d.black&&(d={black:{},goal:"online",af:30,at:100,text:""});MessHandle=function(b,n,q){switch(b.type){case "init":q({name:name,runned:e,storage:d});break;case "save":d=b.storage;try{localStorage.setItem(u,JSON.stringify(d))}catch(m){m==QUOTA_EXCEEDED_ERR&&alert(lang.g_quotaextended)}break;
case "start":setTimeout(function(){a.set_storage_count(a.var_storage_countid)},2E3);a.var_intst=setInterval(function(){a.set_storage_count(a.var_storage_countid)},3E4);e||(e=!0,f=h=",","online"==d.goal?(c('#contacts_table tr[id^="contact-user-"]').each(function(){f+=c(this).prop("id").replace("contact-user-","")+","}),c.post(location.protocol+"//"+location.hostname+location.pathname,{ajax:"1",mod:"users",off:1,clear:0},function(a){r(a,1)},"json")):c("#contact-list .item-list").children("div").each(function(){var a=
parseInt(c(this).prop("id").replace("contact-user-",""));0<a&&-1==f.indexOf(","+a+",")&&-1==h.indexOf(","+a+",")&&!(a in d.black)&&(f+=a+",",g.push({id:a,t:d.text.replace(/{login}/ig,c("a:first",this).text()),F:function(b){b&&(h+=a+",",++k);l(k)}}),l(k))}),w(),e&&t.text(lang.g_sendinggo).css("color","green"));q(!0);break;case "stop":a.var_storage_countid=null;clearInterval(a.var_intst);console.log(a.var_storage_countid);a.set_storage_count(a.var_storage_countid);p();q(!0);break;case "set_storage_id":localStorage.setItem(a.var_site+
"storage_id_"+name,b.data),a.var_storage_id=localStorage[a.var_site+"storage_id_"+name]}};a.init()})(jQuery);